# Windows 快捷键增强工具

一个基于 AutoHotkey v2.0 的 Windows 快捷键增强脚本，提供全局快捷键、应用程序切换、窗口管理、主题控制、媒体控制等功能，显著提升 Windows 使用效率。

## 🚀 主要功能

- **全局快捷键映射**：重新定义常用快捷键，提升操作效率
- **智能应用切换**：一键切换常用应用程序
- **窗口管理**：窗口置顶、透明度控制、半透明穿透
- **智能主题切换**：基于日出日落时间自动切换系统主题
- **桌面时钟**：美观的桌面时钟显示
- **媒体控制**：全局媒体播放控制
- **模拟键盘输入**：智能文本输入功能
- **连点器**：鼠标连点录制和播放
- **键盘锁定**：临时锁定键盘输入

## 📋 系统要求

- **AutoHotkey 版本**：v2.0 或更高版本
- **Windows 版本**：Windows 10/11（推荐）
- **权限要求**：需要管理员权限运行
- **网络连接**：自动主题切换功能需要网络连接

## 🔧 安装和使用

### 安装步骤

1. **下载 AutoHotkey v2.0**
   ```
   https://www.autohotkey.com/
   ```

2. **下载脚本文件**
   - 下载 `hotkey.ahk` 文件到本地目录

3. **运行脚本**
   - 右键点击 `hotkey.ahk` 文件
   - 选择 "以管理员身份运行"
   - 或双击文件（脚本会自动请求管理员权限）

### 开机自启动设置

1. **方法一：启动文件夹**
   - 按 `Win + R`，输入 `shell:startup`
   - 将 `hotkey.ahk` 的快捷方式复制到启动文件夹

2. **方法二：任务计划程序**
   - 打开任务计划程序
   - 创建基本任务，设置为开机启动
   - 程序路径指向 `hotkey.ahk`

## ⌨️ 快捷键列表

### 全局快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `F1` | 复制 | 映射到 Ctrl+C |
| `F2` | 粘贴 | 映射到 Ctrl+V |
| `Win+V` | 剪贴板历史 | 映射到 Ctrl+Shift+Win+\ |
| `Shift+L` | 打开 linux.do | 在默认浏览器中打开 |
| `Shift+R` | 截图翻译 | 映射到 Ctrl+Shift+R |
| `Shift+F` | 新建文件 | 映射到 Ctrl+N |
| `Shift+D` | 连续退格 | 发送 Backspace |
| `Shift+E` | 连续回车 | 发送 Enter |
| `Alt+D` | 搜索/地址栏 | 映射到 Ctrl+K |
| `Alt+F` | 全屏切换 | 映射到 F11 |
| `Alt+Escape` | 显示桌面 | 映射到 Win+D |

### 窗口管理快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Alt+W` | 关闭窗口 | 映射到 Alt+F4（排除Chrome、Zen、Typora） |
| `Alt+\`` | 窗口置顶切换 | 切换当前窗口的置顶状态 |
| `Alt+T` | 半透明穿透 | 切换窗口半透明穿透状态 |
| `Alt+Shift+Up` | 增加透明度 | 使透明窗口更不透明 |
| `Alt+Shift+Down` | 减少透明度 | 使透明窗口更透明 |

### 应用程序切换快捷键

| 快捷键 | 应用程序 | 功能 |
|--------|----------|------|
| `Shift+G` | Chrome | 切换/启动 Chrome 浏览器 |
| `Shift+T` | Telegram | 切换/启动 Telegram |
| `Shift+N` | Notion | 切换/启动 Notion |
| `Shift+Z` | Zen Browser | 切换/启动 Zen 浏览器 |
| `Shift+S` | Spotify | 切换/启动 Spotify |
| `Shift+W` | 微信 | 切换/启动微信 |

### 虚拟桌面快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Alt+1` | 切换到左侧桌面 | 映射到 Win+Ctrl+Left |
| `Alt+2` | 新建桌面 | 映射到 Win+Ctrl+D |
| `Alt+3` | 切换到右侧桌面 | 映射到 Win+Ctrl+Right |
| `Alt+4` | 关闭当前桌面 | 映射到 Win+Ctrl+F4 |

### 主题和桌面控制

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Win+Shift+T` | 手动切换主题 | 切换亮色/暗色主题并关闭自动切换 |
| `Win+Shift+O` | 显示日出日落时间 | 显示当前日出日落信息 |
| `Win+Shift+A` | 切换自动主题 | 开启/关闭自动主题切换功能 |
| `Ctrl+Alt+C` | 桌面时钟切换 | 显示/隐藏桌面时钟 |

### 媒体控制快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Alt+Space` | 播放/暂停 | 媒体播放控制 |
| `Ctrl+Alt+Right` | 下一首 | 切换到下一首 |
| `Ctrl+Alt+Left` | 上一首 | 切换到上一首 |
| `Ctrl+Alt+Up` | 音量增加 | 增加系统音量 |
| `Ctrl+Alt+Down` | 音量减小 | 减小系统音量 |
| `Ctrl+Alt+M` | 静音切换 | 切换静音状态 |

### 模拟键盘输入

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Alt+V` | 模拟输入模式 | 模拟输入剪贴板内容（正常速度） |
| `Ctrl+Alt+V` | 慢速模拟输入 | 模拟输入剪贴板内容（慢速） |

**模拟输入模式下的控制：**
- `Space`：暂停/继续输入
- `Escape`：退出模拟输入模式

### 连点器功能

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Shift+D` | 进入连点器模式 | 激活连点器功能 |

**连点器模式下的控制：**
- `Ctrl+左键`：重置并开始记录点击位置
- `Space`：开始/停止无限循环播放
- `Ctrl+Shift+数字键盘+`：加速播放
- `Ctrl+Shift+数字键盘-`：减速播放
- `Escape`：退出连点器模式

### 键盘锁定功能

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Alt+L` | 锁定键盘 | 锁定所有键盘输入 |
| 鼠标双击 | 解锁键盘 | 双击鼠标解锁键盘 |

## 🎯 特定应用程序快捷键

### Chrome 浏览器快捷键
*（仅在 Chrome 窗口激活时生效）*

| 快捷键 | 功能 | 映射到 |
|--------|------|--------|
| `Shift+A` | 打开最近关闭的标签页 | Ctrl+Shift+A |
| `Alt+Q` | 新建标签页 | Ctrl+T |
| `Alt+Z` | 显示/隐藏书签栏 | Ctrl+Shift+B |
| `Shift+B` | 自动填充密码 | Ctrl+Shift+M |
| `Alt+W` | 关闭标签页 | Ctrl+W |
| `Alt+[` | 后退 | Alt+Left |
| `Alt+]` | 前进 | Alt+Right |

### Typora 快捷键
*（仅在 Typora 窗口激活时生效）*

| 快捷键 | 功能 | 映射到 |
|--------|------|--------|
| `Alt+Q` | 插入数学公式 | Ctrl+Shift+M |
| `Alt+W` | 插入代码块 | Ctrl+Shift+K |
| `Alt+1` ~ `Alt+6` | 设置标题级别 | Ctrl+1 ~ Ctrl+6 |

### Word 快捷键
*（仅在 Word 窗口激活时生效）*

| 快捷键 | 功能 | 映射到 |
|--------|------|--------|
| `Shift+S` | 打开样式面板 | Ctrl+Alt+Shift+S |
| `Shift+C` | 复制格式 | Ctrl+Alt+C |
| `Shift+V` | 粘贴格式 | Ctrl+Alt+V |

### PyCharm 快捷键
*（仅在 PyCharm 窗口激活时生效）*

| 快捷键 | 功能 | 映射到 |
|--------|------|--------|
| `Alt+R` | 运行当前配置 | Ctrl+Shift+F10 |

### Zen 浏览器快捷键
*（仅在 Zen 浏览器窗口激活时生效）*

| 快捷键 | 功能 | 映射到 |
|--------|------|--------|
| `Shift+B` | 功能B | Ctrl+Alt+B |
| `Alt+A` | 功能A | Ctrl+Alt+A |
| `Alt+Q` | 功能Q | Ctrl+Alt+Q |
| `Alt+W` | 功能W | Ctrl+Alt+W |
| `Alt+D` | 功能D | Ctrl+Alt+D |

## 🔧 功能详细说明

### 桌面时钟
- **位置**：屏幕右上角
- **样式**：圆角半透明设计，自动适配系统主题
- **功能**：实时显示当前时间，支持亮色/暗色主题自动切换
- **控制**：使用 `Ctrl+Alt+C` 切换显示/隐藏

### 智能主题切换
- **自动模式**：基于日出日落时间自动切换系统主题
- **API来源**：使用 sunrise-sunset.org API 获取日出日落时间
- **默认位置**：北京（纬度36.52，经度118.46）
- **检查频率**：每5分钟检查一次
- **手动控制**：
  - `Win+Shift+T`：手动切换主题并关闭自动模式
  - `Win+Shift+A`：开启/关闭自动主题功能
  - `Win+Shift+O`：显示当前日出日落时间

### 应用程序切换逻辑
- **已运行且激活**：最小化应用（微信和Spotify会关闭主窗口但保持托盘运行）
- **已运行未激活**：激活并前置应用窗口
- **未运行**：启动应用程序

### 窗口管理功能
- **置顶功能**：`Alt+\`` 切换当前窗口的置顶状态
- **半透明穿透**：`Alt+T` 使窗口半透明且鼠标点击穿透
- **透明度调节**：
  - `Alt+Shift+Up`：增加透明度（更不透明）
  - `Alt+Shift+Down`：减少透明度（更透明）
  - 透明度范围：50-255

### 模拟键盘输入
- **智能输入**：支持复杂文本的逐字符模拟输入
- **速度控制**：提供正常速度和慢速两种模式
- **实时控制**：输入过程中可暂停/继续/退出
- **进度显示**：显示输入进度和状态
- **使用场景**：适用于需要模拟人工输入的场景

### 连点器功能
- **录制模式**：按住 `Ctrl+左键` 录制点击位置
- **播放模式**：支持无限循环播放
- **速度调节**：可调节播放间隔（10-2000毫秒）
- **状态显示**：实时显示录制/播放状态
- **使用场景**：自动化重复点击操作

### 键盘锁定功能
- **锁定范围**：所有键盘按键（包括功能键、数字键盘等）
- **解锁方式**：鼠标双击解锁
- **安全性**：防止误操作，适用于临时离开电脑时使用

## ⚙️ 配置选项

### 可自定义的配置参数

**桌面时钟配置（ClockConfig类）：**
```autohotkey
WINDOW_WIDTH := 95          ; 时钟窗口宽度
WINDOW_HEIGHT := 22         ; 时钟窗口高度
CORNER_RADIUS := 11         ; 圆角半径
UPDATE_INTERVAL := 1000     ; 更新间隔（毫秒）
FONT_SIZE_TIME := 9         ; 字体大小
TRANSPARENCY := 150         ; 透明度
```

**全局配置（Config类）：**
```autohotkey
TRANSPARENCY_STEP := 15         ; 透明度调整步长
DEFAULT_TRANSPARENCY := 180     ; 默认透明度
OSD_DISPLAY_TIME := 800         ; OSD显示时间
DOUBLE_CLICK_THRESHOLD := 500   ; 双击检测阈值
TYPING_DELAY_FAST := 10         ; 快速输入延迟
TYPING_DELAY_SLOW := 50         ; 慢速输入延迟
OSD_FADE_TIME := 500            ; OSD淡出时间
```

**日出日落配置（SunriseSunset类）：**
```autohotkey
DEFAULT_LAT := 36.52            ; 默认纬度（北京）
DEFAULT_LNG := 118.46           ; 默认经度（北京）
CHECK_INTERVAL := 300000        ; 检查间隔（5分钟）
```

### 应用程序路径配置

如需修改应用程序启动路径，请编辑以下行：
```autohotkey
+t::ToggleApp("Telegram.exe", "C:\APP\Telegram\Telegram.exe")
+w::ToggleApp("Weixin.exe", "C:\APP\Weixin\Weixin.exe")
+z::ToggleApp("zen.exe", "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Zen.lnk")
```

## 📝 日志和故障排除

### 日志文件位置
- **错误日志**：`hotkey_errors.log`（脚本目录下）
- **信息日志**：`hotkey_info.log`（脚本目录下）
- **日志保留**：自动保留最近3天的日志

### 常见问题解决

**1. 脚本无法启动**
- 确保以管理员权限运行
- 检查 AutoHotkey v2.0 是否正确安装
- 查看错误日志了解具体错误信息

**2. 某些快捷键不生效**
- 检查是否与其他软件快捷键冲突
- 确认目标应用程序是否正在运行
- 查看信息日志了解快捷键执行情况

**3. 自动主题切换不工作**
- 检查网络连接是否正常
- 查看错误日志中的API请求错误
- 确认系统时间设置正确

**4. 应用程序切换失败**
- 检查应用程序路径是否正确
- 确认应用程序是否已安装
- 查看日志中的应用程序启动错误

**5. 桌面时钟不显示**
- 检查屏幕分辨率设置
- 确认时钟位置是否在屏幕范围内
- 查看时钟初始化相关日志

### 性能优化建议
- 定期清理日志文件
- 根据需要调整检查间隔
- 关闭不需要的功能以减少资源占用

## 🤝 贡献和反馈

如果您在使用过程中遇到问题或有改进建议，欢迎：
- 查看日志文件获取详细错误信息
- 根据需要调整配置参数
- 分享使用经验和优化建议

## 📄 许可证

本项目基于 MIT 许可证开源。

---

**注意**：本脚本需要管理员权限运行，请确保从可信来源获取脚本文件。使用前建议先在测试环境中验证功能。
